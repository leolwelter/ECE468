;str input  "Please enter an integer number: "
;str eol  "\n"

;LABEL   factorial
;LINK   
;STOREI 1  $T1
;NE $P1 $T1 label0
;STOREI 1  $T2
;STOREI $T2  $R
;RET   
;JUMP   label1
;LABEL   label0
;STOREI 1  $T3
;STOREI 1  $T4
;NE $T4 $T3 label2
;SUBI $P1 1 $T5
;PUSH   
;PUSH $T5  
;JSR factorial  
;POP   
;POP $T6  
;STOREI $T6  $L2
;MULTI $L2 $P1 $T7
;STOREI $T7  $L1
;JUMP   label1
;LABEL   label1
;LABEL   label2
;STOREI $L1  $T7
;STOREI $T7  $R
;RET   

;LABEL   main
;LINK   
;WRITES input  
;READI $L1  
;STOREI 1  $T1
;NE $L1 $T1 label3
;STOREI 1  $T2
;STOREI $T2  $L2
;JUMP   label4
;LABEL   label3
;STOREI 1  $T3
;LE $L1 $T3 label5
;PUSH   
;PUSH $L1  
;JSR factorial  
;POP   
;POP $T4  
;STOREI $T4  $L2
;JUMP   label4
;LABEL   label5
;STOREI 1  $T5
;STOREI 1  $T6
;NE $T6 $T5 label6
;STOREI 0  $T7
;STOREI $T7  $L2
;JUMP   label4
;LABEL   label4
;LABEL   label6
;WRITEI $L2  
;WRITES eol  
;STOREI 0  $T8
;STOREI $T8  $R
;RET   

str input "Please enter an integer number: "
str eol "\n"
push  
push r0 
push r1 
push r2 
push r3 
jsr main 
sys halt 
label factorial 
link 3 
move 1 r0
cmpi $6 r0
jne label0 
move 1 r1
move r1 $7
unlnk  
ret  
jmp label1 
label label0 
move 1 r2
move 1 r3
cmpi r3 r2
jne label2 
move $6 r4
subi 1 r4
push  
push r4 
push r0 
push r1 
push r2 
push r3 
jsr factorial 
pop r3 
pop r2 
pop r1 
pop r0 
pop  
pop r5 
move r5 $-2
move $-2 r6
muli $6 r6
move r6 $-1
jmp label1 
label label1 
label label2 
move $-1 r6
move r6 $7
unlnk  
ret  
label main 
link 3 
sys writes input
sys readi $-1
move 1 r0
cmpi $-1 r0
jne label3 
move 1 r1
move r1 $-2
jmp label4 
label label3 
move 1 r2
cmpi $-1 r2
jle label5 
push  
push $-1 
push r0 
push r1 
push r2 
push r3 
jsr factorial 
pop r3 
pop r2 
pop r1 
pop r0 
pop  
pop r3 
move r3 $-2
jmp label4 
label label5 
move 1 r4
move 1 r5
cmpi r5 r4
jne label6 
move 0 r6
move r6 $-2
jmp label4 
label label4 
label label6 
sys writei $-2
sys writes eol
move 0 r7
move r7 $6
unlnk  
ret  
end  
